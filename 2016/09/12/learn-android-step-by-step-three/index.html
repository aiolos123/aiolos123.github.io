<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="android," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="本文为android入门的第二课的第二部分，学习了android高级控件、View视图的相关知识。学习来源：http://www.imooc.com/learn/107">
<meta property="og:type" content="article">
<meta property="og:title" content="android入门三">
<meta property="og:url" content="https://aiolos123.github.io/2016/09/12/learn-android-step-by-step-three/index.html">
<meta property="og:site_name" content="Aiolos Home">
<meta property="og:description" content="本文为android入门的第二课的第二部分，学习了android高级控件、View视图的相关知识。学习来源：http://www.imooc.com/learn/107">
<meta property="og:image" content="http://ocej2soxx.bkt.clouddn.com/Fragment_callback.jpg">
<meta property="og:updated_time" content="2016-09-14T06:02:02.755Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="android入门三">
<meta name="twitter:description" content="本文为android入门的第二课的第二部分，学习了android高级控件、View视图的相关知识。学习来源：http://www.imooc.com/learn/107">
<meta name="twitter:image" content="http://ocej2soxx.bkt.clouddn.com/Fragment_callback.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="https://aiolos123.github.io/2016/09/12/learn-android-step-by-step-three/"/>

  <title> android入门三 | Aiolos Home </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=58061634";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Aiolos Home</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">记录aiolos的学习成长</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                android入门三
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-12T15:12:10+08:00" content="2016-09-12">
              2016-09-12
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/12/learn-android-step-by-step-three/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/12/learn-android-step-by-step-three/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/09/12/learn-android-step-by-step-three/" class="leancloud_visitors" data-flag-title="android入门三">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>本文为android入门的第二课的第二部分，学习了android高级控件、View视图的相关知识。<br>学习来源：<a href="http://www.imooc.com/learn/107" target="_blank" rel="external">http://www.imooc.com/learn/107</a><br><a id="more"></a></p>
<h2 id="Fragment基础"><a href="#Fragment基础" class="headerlink" title="Fragment基础"></a>Fragment基础</h2><p>android3.0引入Fragment的概念，主要目的是用在大屏幕设备上，如平板电脑，支持更加动态和灵活的UI设计。————类似于iframe</p>
<pre><code>1、Fragment可以作为Activity界面的一部分组成出现；
2、可以在一个Activity中同时出现多个Fragment，并且一个Fragment也可以在多个
Activity中使用；
3、在Activity运行过程中，可以添加、移除或替换Fragment；
4、Fragment可以响应自己的输入事件，并且有自己的生命周期，它们的生命周期会受宿主Activity的生命周期影响；
</code></pre><h3 id="Fragment设计哲学"><a href="#Fragment设计哲学" class="headerlink" title="Fragment设计哲学"></a>Fragment设计哲学</h3><p>Fragment在应用中是一个模块化和可重用的组件，因为Fragment定义了它自己的布局，以及通过使用它自己的生命周期回调方法定义了自己的行为，你可以将Fragment包含到多个Activity中。</p>
<h3 id="加载Fragment的两种方式"><a href="#加载Fragment的两种方式" class="headerlink" title="加载Fragment的两种方式"></a>加载Fragment的两种方式</h3><pre><code>静态加载和动态加载
</code></pre><h3 id="静态加载Fragment的四个步骤"><a href="#静态加载Fragment的四个步骤" class="headerlink" title="静态加载Fragment的四个步骤"></a>静态加载Fragment的四个步骤</h3><p>1、创建一个包含Fragment组件的布局文件<br>命名为main.xml<br><figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></div><div class="line">        &lt;!<span class="attr">--</span>静态加载<span class="attr">Fragment</span>必须声明<span class="attr">fragment</span>的唯一<span class="attr">ID</span>或<span class="attr">tag--</span>&gt;</div><div class="line">        android:id="@+id/fragment"</div><div class="line">        android:layout_width="wrap_content"</div><div class="line">        android:layout_height="wrap_content"</div><div class="line">        <span class="comment">&lt;!--指定到自定义的Fragment子类--&gt;</span></div><div class="line">        android:name="com.example.testdemo.MyFragment"</div><div class="line">        /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、创建一个fragment布局文件<br>同普通的activity布局文件一样，命名为fragment.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/tv"</span> </div><div class="line">        <span class="attr">...</span>/&gt;</div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/btn_fg"</span> </div><div class="line">        <span class="attr">...</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>3、创建继承自Fragment或其子类的java类<br>命名为：MyFragment.java<br>全路径为：com.example.testdemo.MyFragment————将在包含了Fragment组件的布局文件main.xml中用到该路径<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.example.testdemo;</div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//自定义Fragment的子类的作用是——通过onCreateView()</span></div><div class="line">    <span class="comment">//实现将fragment布局文件fragment.xml转换成View对象</span></div><div class="line">    <span class="comment">//并完成其组件的初始化工作</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container,</div><div class="line">            <span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">//通过inflater.inflate()方法将fragment布局文件——fragment.xml转换成View对象</span></div><div class="line">        <span class="comment">//inflater.inflate(resource,root,attactToRoot)三个参数的含义：</span></div><div class="line">        <span class="comment">//resource: 需要加载的fragment布局文件</span></div><div class="line">        <span class="comment">//root: 加载fragment布局文件的父ViewGroup，以实现将fragment添加到activity中</span></div><div class="line">        <span class="comment">//attactToRoot:false表示不返回父ViewGroup;true表示返回父ViewGroup</span></div><div class="line">        <span class="type">View</span> view = inflater.inflate(<span class="type">R</span>.layout.fragment, container,<span class="literal">false</span>);</div><div class="line">        </div><div class="line">        <span class="comment">//在fragment中使用findViewById()一定要加上view.</span></div><div class="line">        <span class="comment">//因为fragment的布局文件是保存到view对象中的</span></div><div class="line">        <span class="type">TextView</span> text= (<span class="type">TextView</span>)view.findViewById(<span class="type">R</span>.id.tv);</div><div class="line">        text.setText(<span class="string">"静态加载fragment"</span>);</div><div class="line">        <span class="keyword">return</span> view; </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4、在Activity中使用fragment中的组件<br>可以直接在Activity中使用fragment中的组件，如同定义在activity布局文件中一样。</p>
<p>因为：setContentView()方法在加载包含Fragment组件的布局文件main.xml时，<br>会通过层层查找，查找到fragment布局文件fragment.xml中的所有组件。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="type">TextView</span> tv;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(<span class="type">R</span>.layout.main);</div><div class="line">        </div><div class="line">        <span class="comment">//在Activity中使用fragment中的组件id为tv的TextView</span></div><div class="line">        tv = (<span class="type">TextView</span>)findViewById(<span class="type">R</span>.id.tv);</div><div class="line">        <span class="comment">//在Activity中使用fragment中的组件id为btn_fg的Button</span></div><div class="line">        <span class="type">Button</span> btn = (<span class="type">Button</span>)findViewById(<span class="type">R</span>.id.btn_fg);</div><div class="line">        btn.setText(<span class="string">"改变"</span>);</div><div class="line">        <span class="comment">//改变fragment中textview中的值</span></div><div class="line">        btn.setOnClickListener(<span class="keyword">new</span> <span class="type">OnClickListener</span>() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            public void onClick(<span class="type">View</span> v) &#123;</div><div class="line">                tv.setText(<span class="string">"TextView被改变了"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注：<br>1、onCreateView()方法<br>    Fragment第一次绘制它的用户界面时，系统会调用此方法，为了绘制Fragment的UI，<br>    此方法必须返回一个View；如果不需要显示UI，返回null即可。<br>2、在Activity的layout文件中声明Fragment组件，需要特别注意的是<fragment>标签中的android:name属性需要指定为一个Fragment的子类<br>3、标识Fragment的方法<br>    android:id  属性提供一个唯一ID<br>    android:tag 属性提供一个唯一字符串<br>4、静态加载Fragment必须要在fragment标签中编写唯一标识id或tag，否则程序会报错崩溃。<br>5、自定义的Fragment子类的作用是——通过onCreateView()实现将fragment布局文件转换成View对象，并完成组件的初始化工作。</fragment></p>
<h3 id="动态加载Fragment的四个步骤"><a href="#动态加载Fragment的四个步骤" class="headerlink" title="动态加载Fragment的四个步骤"></a>动态加载Fragment的四个步骤</h3><p>编写代码将Fragment添加到一个Activity layout中</p>
<p>1、编写fragment布局xml文件<br>命名为fragment.xml，内容同静态加载中的fragment.xml<br>2、创建继承自Fragment或其子类的java类<br>命名为DyncFragment.java<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//动态加载Fragment</span></div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">DyncFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container,</div><div class="line">            <span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        </div><div class="line">        <span class="type">View</span> view = inflater.inflate(<span class="type">R</span>.layout.fragment, container,<span class="literal">false</span>);</div><div class="line">        <span class="type">TextView</span> tv = (<span class="type">TextView</span>)view.findViewById(<span class="type">R</span>.id.tv);</div><div class="line">        tv.setText(<span class="string">"动态加载Fragment"</span>);</div><div class="line">        <span class="keyword">return</span> view;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3、编写用于动态加载Fragment的父View容器的布局文件<br>命名为main.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 用于动态加载Fragment的父View容器 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span> </span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/dync"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>4、在Activity中动态加载fragment<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(<span class="type">R</span>.layout.main);</div><div class="line">        </div><div class="line">        <span class="comment">//实例化自定义Fragment子类</span></div><div class="line">        <span class="type">DyncFragment</span> dyncFrag = <span class="keyword">new</span> <span class="type">DyncFragment</span>();</div><div class="line">        <span class="comment">//获取FragmentManager对象</span></div><div class="line">        <span class="type">FragmentManager</span> fmanager = getFragmentManager();</div><div class="line">        <span class="comment">//获取开启事务的对象</span></div><div class="line">        <span class="type">FragmentTransaction</span> trans =  fmanager.beginTransaction();</div><div class="line">        </div><div class="line">        <span class="comment">//使用add()动态加载Fragment，实现添加一个Fragment(指定要添加的fragment对象和插入的View)</span></div><div class="line">        <span class="comment">//与之类似的还有remove()、replace()方法</span></div><div class="line">        </div><div class="line">        <span class="comment">//add()方法需要2个参数：</span></div><div class="line">        <span class="comment">//第一个参数表示要将Fragment对象加载到哪个父布局id中</span></div><div class="line">        <span class="comment">//第二个参数表示将要加载的Fragment对象</span></div><div class="line">        trans.add(<span class="type">R</span>.id.dync, dyncFrag);<span class="comment">//dync的ID为main.xml中的LineaLayout</span></div><div class="line">        <span class="comment">//还可以进行其他操作，如</span></div><div class="line">        <span class="comment">//trans.replace(...);</span></div><div class="line">        <span class="comment">//trans.remove(...);</span></div><div class="line">        <span class="comment">//添加回退功能</span></div><div class="line">        trans.addToBackStack(<span class="literal">null</span>);</div><div class="line">        <span class="comment">//提交事务</span></div><div class="line">        trans.commit();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>注：<strong>处理Fragment事务————类似与数据库的事务</strong></p>
<pre><code>根据用户的交互情况，对Fragment进行添加、移除、替换，以及执行其他动作，提交给Activity的每一套变化被称为一个事务

//获取Fragment事务
FragmentManager fmanager = getFragmentManager();
FragmentTransaction transaciton = fmanager.beginTransaction();

每一个事务都是同时执行一套变化，可以在一个事务中设置你所有想执行的变化，
包括add()、remove()、replace()，然后提交给Activity时必须调用commit()方法。

如果允许用户通过按下back物理按键返回到前一个Fragment状态，调用commit()之前可以加入addToBackStack()方法。
</code></pre><h3 id="Fragment生命周期"><a href="#Fragment生命周期" class="headerlink" title="Fragment生命周期"></a>Fragment生命周期</h3><p>Fragment可以响应自己的输入事件，并且有自己的生命周期，它们的生命周期会受宿主Activity的生命周期影响；</p>
<p>Activity生命周期的每个状态下都会对应一个或多个Fragment的回调函数，如下图<br><img src="http://ocej2soxx.bkt.clouddn.com/Fragment_callback.jpg" alt="Activity生命周期的每个状态下对应的Fragment的回调函数"></p>
<h4 id="Fragment生命周期各方法详解"><a href="#Fragment生命周期各方法详解" class="headerlink" title="Fragment生命周期各方法详解"></a>Fragment生命周期各方法详解</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">FragmentLife</span> <span class="selector-tag">extends</span> <span class="selector-tag">Fragment</span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//Fragment生命周期的第一个方法</span></div><div class="line">    <span class="comment">//当Fragment被添加到Activity时会回调该方法，</span></div><div class="line">    <span class="comment">//并且这个方法只调用一次</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onAttach(Activity activity) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onAttach</span>(activity);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"///////启动Fragment开始/////////////////////////////////"</span>);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onAttach()"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//在创建Fragment时会回调该方法，并且这个方法只调用一次</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onCreate</span>(savedInstanceState);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onCreate()"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//每次创建Fragment，绘制Fragment的View组件时回调该方法</span></div><div class="line">    <span class="comment">//这个访问的作用是为Fragment绑定一个布局文件，然后转换成View对象返回</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public View onCreateView(LayoutInflater inflater, ViewGroup container,</div><div class="line">            Bundle savedInstanceState) &#123;</div><div class="line">        </div><div class="line">        View view = inflater<span class="selector-class">.inflate</span>(R.layout.fragment, container,false);</div><div class="line">        TextView tv=(TextView)view<span class="selector-class">.findViewById</span>(R.id.tv);</div><div class="line">        tv<span class="selector-class">.setText</span>(<span class="string">"第一个Fragment"</span>);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onCreateView()"</span>);</div><div class="line">        return view;</div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    <span class="comment">//当Fragment所在的Activity启动完成后回调该方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onActivityCreated(Bundle savedInstanceState) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onActivityCreated</span>(savedInstanceState);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onActivityCreated()"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">//启动Fragment时回调该方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onStart() &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onStart</span>();</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onStart()"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//恢复Fragment时回调该方法</span></div><div class="line">    <span class="comment">//调用onStart()方法后一定会调用onResume()方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onResume() &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onResume</span>();</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onResume()"</span>);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"///////启动Fragment结束/////////////////////////////////"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//暂停Fragment时回调该方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onPause() &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onPause</span>();</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"///////停止Fragment开始/////////////////////////////////"</span>);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onPause()"</span>);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//停止Fragment时回调该方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onStop() &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onStop</span>();</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onStop()"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//销毁Fragment所包含的View组件时回调该方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onDestroyView() &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onDestroyView</span>();</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onDestroyView()"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//销毁Fragment时回调该方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onDestroy() &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onDestroy</span>();</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onDestroy()"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//Fragment从Activity中删除时回调该方法，并且这个方法只调用一次</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onDetach() &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        super<span class="selector-class">.onDetach</span>();</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"FragmentLife——————onDetach()"</span>);</div><div class="line">        Log<span class="selector-class">.i</span>(<span class="string">"Main"</span>,<span class="string">"///////关闭Fragment结束/////////////////////////////////"</span>);</div><div class="line">    &#125;   </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Fragment生命周期各方法执行顺序"><a href="#Fragment生命周期各方法执行顺序" class="headerlink" title="Fragment生命周期各方法执行顺序"></a>Fragment生命周期各方法执行顺序</h4><figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1、启动Fragment</span></div><div class="line">        <span class="function"><span class="title">onAttach</span>()--&gt;</span><span class="function"><span class="title">onCreate</span>()--&gt;</span><span class="function"><span class="title">onCreateView</span>()--&gt;</span>onActivityCreated()</div><div class="line">        --&gt;<span class="function"><span class="title">onStart</span>()--&gt;</span>onResume()</div><div class="line"><span class="comment">//2、屏幕锁屏</span></div><div class="line">        <span class="function"><span class="title">onPause</span>()--&gt;</span>onStop()</div><div class="line"><span class="comment">//3、屏幕解锁</span></div><div class="line">        <span class="function"><span class="title">onStart</span>()--&gt;</span>onResume()</div><div class="line"><span class="comment">//4、从第一个Fragment切换到第二个Fragment</span></div><div class="line">        第一个F<span class="function"><span class="title">ragment</span>停止：onPause()--&gt;</span><span class="function"><span class="title">onStop</span>()--&gt;</span>onDestroyView()</div><div class="line">        --&gt;<span class="function"><span class="title">onDestroy</span>()--&gt;</span>onDetach()</div><div class="line">        第二个F<span class="function"><span class="title">ragment</span>启动：onAttach()--&gt;</span><span class="function"><span class="title">onCreate</span>()--&gt;</span>onCreateView()</div><div class="line">        --&gt;<span class="function"><span class="title">onActivityCreated</span>()--&gt;</span><span class="function"><span class="title">onStart</span>()--&gt;</span>onResume()</div><div class="line"><span class="comment">//5、从启动到销毁Fragment全过程</span></div><div class="line">        <span class="function"><span class="title">onAttach</span>()--&gt;</span><span class="function"><span class="title">onCreate</span>()--&gt;</span><span class="function"><span class="title">onCreateView</span>()--&gt;</span><span class="function"><span class="title">onActivityCreated</span>()--&gt;</span><span class="function"><span class="title">onStart</span>()--&gt;</span>onResume()</div><div class="line">        --&gt;<span class="function"><span class="title">onPause</span>()--&gt;</span><span class="function"><span class="title">onStop</span>()--&gt;</span><span class="function"><span class="title">onDestroyView</span>()--&gt;</span><span class="function"><span class="title">onDestroy</span>()--&gt;</span>onDetach()</div></pre></td></tr></table></figure>
<h3 id="Fragment与Activity通信"><a href="#Fragment与Activity通信" class="headerlink" title="Fragment与Activity通信"></a>Fragment与Activity通信</h3><p>1、在Fragment中，可调用getActivity()方法获取它所在的宿主Activity<br>2、在Activity中，可调用FragmentManager的findFragmentById()或findFragmentByTag()方法获取静态加载的Fragment</p>
<h4 id="Activity向Fragment传递数据——动态加载fragment"><a href="#Activity向Fragment传递数据——动态加载fragment" class="headerlink" title="Activity向Fragment传递数据——动态加载fragment"></a>Activity向Fragment传递数据——动态加载fragment</h4><p>1、在Activity中向Fragment传递数据<br>思路:在Activity中创建Bundle数据包，并调用Fragment的setArguments(Bundle bundle)方法传递数据包到Fragment中。<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">MainActivity</span> <span class="selector-tag">extends</span> <span class="selector-tag">Activity</span>&#123;</div><div class="line">    </div><div class="line">    private EditText et;</div><div class="line">    private Button send;</div><div class="line">    <span class="variable">@Override</span></div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super<span class="selector-class">.onCreate</span>(savedInstanceState);</div><div class="line">        setContentView(R<span class="selector-class">.layout</span><span class="selector-class">.main4</span>);</div><div class="line">        </div><div class="line">        </div><div class="line">        et = (EditText) findViewById(R<span class="selector-class">.id</span><span class="selector-class">.et</span>);</div><div class="line">        send = (Button) findViewById(R<span class="selector-class">.id</span><span class="selector-class">.send</span>);</div><div class="line">        </div><div class="line">        <span class="selector-tag">send</span><span class="selector-class">.setOnClickListener</span>(new OnClickListener() &#123;</div><div class="line">            </div><div class="line">            <span class="variable">@Override</span></div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                String txt = et<span class="selector-class">.getText</span>()<span class="selector-class">.toString</span>();</div><div class="line">                </div><div class="line">                <span class="comment">//在Activity中向Fragment传递数据的步骤</span></div><div class="line"></div><div class="line">                <span class="comment">//1、实例化自定义Fragment类对象</span></div><div class="line">                AcceptActivityFragment aaf = new AcceptActivityFragment();</div><div class="line">                <span class="comment">//2、初始化Bundle对象，并添加数据</span></div><div class="line">                Bundle bundle = new Bundle();</div><div class="line">                bundle<span class="selector-class">.putString</span>(<span class="string">"name"</span>,txt);</div><div class="line">                <span class="comment">//3、向自定义Fragment类对象传递数据包</span></div><div class="line">                aaf<span class="selector-class">.setArguments</span>(bundle);</div><div class="line">                </div><div class="line">                <span class="comment">//4、动态加载自定义Fragment</span></div><div class="line">                FragmentManager fm = getFragmentManager();</div><div class="line">                FragmentTransaction ft = fm<span class="selector-class">.beginTransaction</span>();</div><div class="line">                ft<span class="selector-class">.add</span>(R.id.layout, aaf, <span class="string">"AcceptActivityFragment"</span>);</div><div class="line">                ft<span class="selector-class">.commit</span>();</div><div class="line">                </div><div class="line">                Toast<span class="selector-class">.makeText</span>(MainActivity4.this,<span class="string">"Activity向Fragment发送数据"</span>+txt,Toast.LENGTH_SHORT)<span class="selector-class">.show</span>();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2、在Fragment中接收Activity传递过来的数据<br>思路：在Fragment中通过getArguments()方法获取传递过来的Bundle数据包对象，再调用Bundle对象的get(key)方法获取数据内容<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">AcceptActivityFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container,</div><div class="line">            <span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="type">View</span> view = inflater.inflate(<span class="type">R</span>.layout.fragment, container,<span class="literal">false</span>);</div><div class="line">        <span class="type">TextView</span> tv=(<span class="type">TextView</span>)view.findViewById(<span class="type">R</span>.id.tv);</div><div class="line">        </div><div class="line">        <span class="comment">//在Fragment中接收Activity传递过来的数据的步骤</span></div><div class="line">        <span class="comment">//1、使用getArguments()方法获取传递过来的数据包</span></div><div class="line">        <span class="type">Bundle</span> bun =  getArguments();</div><div class="line">        <span class="comment">//2、调用Bundle的get(key)方法获取数据内容</span></div><div class="line">        <span class="type">String</span>  txt = bun.get(<span class="string">"name"</span>)+<span class="string">""</span>;</div><div class="line"></div><div class="line">        <span class="comment">//上述1、2两步可合并为下面的写法</span></div><div class="line">        <span class="comment">//String  txt = getArguments().get("name")+"";</span></div><div class="line">        </div><div class="line">        tv.setText(txt);</div><div class="line">        <span class="type">Toast</span>.makeText(getActivity(),<span class="string">"Fragment已成功接收到"</span>+txt,<span class="type">Toast</span>.<span class="type">LENGTH_SHORT</span>).show();</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> view;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<h4 id="Activity向Fragment传递数据——静态加载fragment"><a href="#Activity向Fragment传递数据——静态加载fragment" class="headerlink" title="Activity向Fragment传递数据——静态加载fragment"></a>Activity向Fragment传递数据——静态加载fragment</h4><p>1、静态加载fragment，显示Activity向Fragment传递数据,<br>首先需要在布局文件中声明一个fragment组件，布局文件命名为main4.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></div><div class="line">        <span class="attr">...</span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/send"</span>/&gt;</div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 静态加载Fragment --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">fragment</span> </span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/frag"</span></div><div class="line">        <span class="attr">android:name</span>=<span class="string">"MyFragment2"</span></div><div class="line">        /&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、在Activity中向Fragment传递数据<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(<span class="type">R</span>.layout.main4);</div><div class="line"></div><div class="line">        <span class="comment">//1、静态加载fragment</span></div><div class="line">        <span class="type">FragmentManager</span> fm = getFragmentManager();</div><div class="line">        <span class="type">Fragment</span> frag = fm.findFragmentById(<span class="type">R</span>.id.frag);</div><div class="line">        </div><div class="line">        <span class="comment">//2、将通过findFragmentById()方法获取到的对象转换为MyFragment2类型</span></div><div class="line">        <span class="type">MyFragment2</span> myFrag = (<span class="type">MyFragment2</span>)frag;</div><div class="line"></div><div class="line">        <span class="comment">//3、通过Fragment子类的set方法，在Activity中向Fragment传递数据</span></div><div class="line">        myFrag.setAaa(<span class="string">"fragment静态传值"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3、在Fragment中接收Activity传递过来的数据<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">public class MyFragment2 extends Fragment&#123;</div><div class="line">    </div><div class="line">    private Button btn;</div><div class="line">    <span class="regexp">//</span><span class="number">1</span>、定义用于Activity向Fragment传值的变量及其get、set方法</div><div class="line">    private String aaa;</div><div class="line">    public String getAaa() &#123;</div><div class="line">        return aaa;</div><div class="line">    &#125;</div><div class="line">    public void setAaa(String aaa) &#123;</div><div class="line">        this.aaa = aaa;</div><div class="line">    &#125;</div><div class="line">    @Override</div><div class="line">    public View onCreateView(LayoutInflater inflater, ViewGroup container,</div><div class="line">            Bundle savedInstanceState) &#123;</div><div class="line">        </div><div class="line">        View view = inflater.inflate(R.layout.fragment, container,false);</div><div class="line">        </div><div class="line">        btn = (Button) view.findViewById(R.id.btn_fg);</div><div class="line">        btn.setText(<span class="string">"获取内容"</span>);</div><div class="line">        btn.setOnClickListener(new OnClickListener() &#123;</div><div class="line">        </div><div class="line">        <span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span></div><div class="line">        <span class="regexp">//</span><span class="regexp">/问题：为什么getAaa()在此处执行时无法获取到值/</span><span class="regexp">//</span></div><div class="line">        <span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span><span class="regexp">//</span></div><div class="line">        </div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                <span class="regexp">//</span><span class="number">2</span>、在Fragment中接收Activity传递过来的数据</div><div class="line">                String val = getAaa();</div><div class="line">                Toast.makeText(getActivity(),<span class="string">"value="</span>+val,Toast.LENGTH_SHORT).show();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        return view;  </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="Fragment向Activity传递数据"><a href="#Fragment向Activity传递数据" class="headerlink" title="Fragment向Activity传递数据"></a>Fragment向Activity传递数据</h4><p>1、在Fragment中向Activity传递数据<br>思路:需要在Fragment中定义一个内部回调接口，这样Fragment可调用该回调方法将数据传递给Activity<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> String code = <span class="string">"Thank you,Activity!"</span>;</div><div class="line">    <span class="comment">//2、声明MyListener接口的对象</span></div><div class="line">    <span class="keyword">public</span> MyListener listener; </div><div class="line">    </div><div class="line">    <span class="comment">//1、声明一个内部接口MyListener</span></div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyListener</span></span>&#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">thank</span><span class="params">(String code)</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//Fragment生命周期的第一个方法，当Fragment被添加到Activity时会回调该方法</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttach</span><span class="params">(Activity activity)</span> </span>&#123;</div><div class="line">        <span class="comment">//3、将宿主Activity对象传递给listener对象</span></div><div class="line">        listener=(MyListener)activity;</div><div class="line">        <span class="keyword">super</span>.onAttach(activity);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span></div><div class="line">            Bundle savedInstanceState) &#123;</div><div class="line">        </div><div class="line">        View view = inflater.inflate(R.layout.fragment, container,<span class="keyword">false</span>);</div><div class="line">        </div><div class="line">        Toast.makeText(getActivity(),<span class="string">"向Activity发送数据"</span>+code,Toast.LENGTH_SHORT).show();</div><div class="line"></div><div class="line">        <span class="comment">//4、宿主activity对象(因第3步的赋值操作)直接调用接口方法，将数据传递给Activity</span></div><div class="line">        listener.thank(code);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> view;   </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2、在Activity中接收Fragment传递过来的数据<br>思路：让包含该Fragment的Activity实现该回调接口<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1、让包含该Fragment的Activity实现该回调接口</span></div><div class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">MainActivity</span> <span class="selector-tag">extends</span> <span class="selector-tag">Activity</span> <span class="selector-tag">implements</span> <span class="selector-tag">MyListener</span>&#123;</div><div class="line">    </div><div class="line">    <span class="variable">@Override</span></div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super<span class="selector-class">.onCreate</span>(savedInstanceState);</div><div class="line">        setContentView(R<span class="selector-class">.layout</span><span class="selector-class">.main4</span>);</div><div class="line">        </div><div class="line">        <span class="comment">//动态加载Fragment</span></div><div class="line">        MyFragment dyncFrag = new MyFragment();</div><div class="line">        FragmentManager fmanager = getFragmentManager();</div><div class="line">        FragmentTransaction trans =  fmanager<span class="selector-class">.beginTransaction</span>();</div><div class="line"></div><div class="line">        trans<span class="selector-class">.add</span>(R.id.dync, dyncFrag);</div><div class="line">        trans<span class="selector-class">.addToBackStack</span>(null);</div><div class="line">        trans<span class="selector-class">.commit</span>();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//2、重写接口实现方法，获取Fragment传递过来的数据</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void thank(String code) &#123;</div><div class="line">        Toast<span class="selector-class">.makeText</span>(MainActivity.this,<span class="string">"已成功接收到Fragment传递过来的"</span>+code,Toast.LENGTH_SHORT)<span class="selector-class">.show</span>();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用ViewPager实现视图左右滑动的页卡效果"><a href="#使用ViewPager实现视图左右滑动的页卡效果" class="headerlink" title="使用ViewPager实现视图左右滑动的页卡效果"></a>使用ViewPager实现视图左右滑动的页卡效果</h2><p>本质：ViewPager是存放View对象或Fragment对象的容器，常用于导航</p>
<p>一些用法：加载显示的页卡时把布局文件转换为View对象的2种方式<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//将layout布局转换为View对象的2种方式</span></div><div class="line"><span class="comment">//第一种方法</span></div><div class="line">LayoutInflater lf = getLayoutInflater().<span class="keyword">from</span>(<span class="keyword">this</span>);</div><div class="line">lf.inflate(resource,root);</div><div class="line"><span class="comment">//第二种方法</span></div><div class="line">View.inflate(context,resource,root);</div></pre></td></tr></table></figure></p>
<p>一些用法：为ViewPager配置适配器<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">一类数据源为<span class="keyword">View</span>集合，另一类数据源为Fragment集合</div><div class="line"><span class="comment">//</span></div><div class="line">PagerAdapter 数据源： <span class="keyword">List</span>&lt;<span class="keyword">View</span>&gt;</div><div class="line"><span class="comment">//</span></div><div class="line">FragmentPagerAdapter 数据源： <span class="keyword">List</span>&lt;Fragment&gt;</div><div class="line"><span class="comment">//</span></div><div class="line">FragmentStatePagerAdapter 数据源： <span class="keyword">List</span>&lt;Fragment&gt;</div></pre></td></tr></table></figure></p>
<h3 id="使用ViewPager的步骤——使用View对象作为ViewPager的数据源"><a href="#使用ViewPager的步骤——使用View对象作为ViewPager的数据源" class="headerlink" title="使用ViewPager的步骤——使用View对象作为ViewPager的数据源"></a>使用ViewPager的步骤——使用View对象作为ViewPager的数据源</h3><p>1、在xml布局文件中声明ViewPager控件，命名为main.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!--在布局文件中声明ViewPager控件与之前的控件不同，</span></div><div class="line">        它是android.support.v4兼容包下的一个控件--&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">android.support.v4.view.ViewPager</span></span></div><div class="line">            <span class="attr">android:id</span>=<span class="string">"@+id/vp"</span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:layout_gravity</span>=<span class="string">"center"</span>&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">android.support.v4.view.ViewPager</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、声明4个用于左右滑动的视图布局文件<br>命名为view.xml,view2.xml,view3.xml,view4.xml<br>内容类似普通布局文件<br>3、自定义PagerAdapter适配器子类MyPagerAdapter<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.support.v4.view.PagerAdapter;</div><div class="line"><span class="comment">//自定义PagerAdapter适配器子类MyPagerAdapter</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyPagerAdapter</span> <span class="keyword">extends</span> <span class="title">PagerAdapter</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//声明存储数据源的对象</span></div><div class="line">    <span class="keyword">private</span> List&lt;View&gt; viewList;</div><div class="line">    </div><div class="line">    <span class="comment">//定义适配器的构造方法</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyPagerAdapter</span><span class="params">(List&lt;View&gt; viewList)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.viewList = viewList;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//返回所有页卡的总数量</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">return</span> viewList.<span class="title">size</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//判断当前View视图对象是否由Object产生</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isViewFromObject</span><span class="params">(View arg0, Object arg1)</span> </span>&#123;</div><div class="line">        <span class="comment">//官方写法</span></div><div class="line">        <span class="keyword">return</span> arg0==arg1;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//增加必须实现的方法——instantiateItem</span></div><div class="line">    <span class="comment">//作用是实例化一个页卡</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function">Object <span class="title">instantiateItem</span><span class="params">(ViewGroup container, <span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="comment">//将view对象添加到ViewGroup中</span></div><div class="line">        <span class="comment">//position为当前view在viewList中的位置</span></div><div class="line">        container.addView(viewList.get(position));</div><div class="line">        <span class="function"><span class="keyword">return</span> viewList.<span class="title">get</span><span class="params">(position)</span></span>;<span class="comment">//返回viewList中当前的view对象</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">//增加必须实现的方法——destroyItem</span></div><div class="line">    <span class="comment">//作用是销毁一个页卡</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">destroyItem</span><span class="params">(ViewGroup container, <span class="keyword">int</span> position, Object object)</span> </span>&#123;</div><div class="line">        <span class="comment">//从ViewGroup中移除一个view对象</span></div><div class="line">        <span class="comment">//position为当前view在viewList中的位置</span></div><div class="line">        container.removeView(viewList.get(position));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4、在MainActivity中配置PagerAdapter适配器，实现4个view视图可以左右滑动的效果<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.support.v4.view.<span class="type">ViewPager</span>;</div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//声明List&lt;View&gt;对象，用于存储ViewPager的数据源</span></div><div class="line">    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">View</span>&gt; viewList;</div><div class="line">    <span class="keyword">private</span> <span class="type">ViewPager</span> vp;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        <span class="comment">//1、编写布局文件，声明android.support.v4.view.ViewPager控件</span></div><div class="line">        setContentView(<span class="type">R</span>.layout.main);</div><div class="line">        </div><div class="line">        <span class="comment">//2、初始化viewList和viewPager对象</span></div><div class="line">        viewList = <span class="keyword">new</span> <span class="type">ArrayList</span>&lt;<span class="type">View</span>&gt;();</div><div class="line">        vp =  (<span class="type">ViewPager</span>) findViewById(<span class="type">R</span>.id.vp);</div><div class="line">        </div><div class="line">        <span class="comment">/*</span></div><div class="line">         * 将View对象作为ViewPager的数据源</div><div class="line">         */</div><div class="line">        </div><div class="line">        <span class="comment">//3、把布局文件转换为View对象——使用第二种方法</span></div><div class="line">        <span class="comment">//View.inflate(上下文,布局文件ID,父组件)</span></div><div class="line">        <span class="type">View</span> v1 = <span class="type">View</span>.inflate(<span class="keyword">this</span>,<span class="type">R</span>.layout.view,<span class="literal">null</span>);</div><div class="line">        <span class="type">View</span> v2 = <span class="type">View</span>.inflate(<span class="keyword">this</span>,<span class="type">R</span>.layout.view2,<span class="literal">null</span>);</div><div class="line">        <span class="type">View</span> v3 = <span class="type">View</span>.inflate(<span class="keyword">this</span>,<span class="type">R</span>.layout.view3,<span class="literal">null</span>);</div><div class="line">        <span class="type">View</span> v4 = <span class="type">View</span>.inflate(<span class="keyword">this</span>,<span class="type">R</span>.layout.view4,<span class="literal">null</span>);</div><div class="line">        </div><div class="line">        <span class="comment">//4、将View对象存储到List集合中，作为ViewPager的数据源</span></div><div class="line">        viewList.add(v1);</div><div class="line">        viewList.add(v2);</div><div class="line">        viewList.add(v3);</div><div class="line">        viewList.add(v4);</div><div class="line">        </div><div class="line">        <span class="comment">//5、自定义PagerAdapter适配器子类MyPagerAdapter</span></div><div class="line">        </div><div class="line">        <span class="comment">//6、实例化PagerAdapter适配器子类MyPagerAdapter对象</span></div><div class="line">        <span class="type">MyPagerAdapter</span> ad = <span class="keyword">new</span> <span class="type">MyPagerAdapter</span>(viewList);</div><div class="line">        </div><div class="line">        <span class="comment">//7、为ViewPager加载适配器</span></div><div class="line">        vp.setAdapter(ad);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="使用PagerTabStrip和PagerTitleStrip实现页卡标题效果"><a href="#使用PagerTabStrip和PagerTitleStrip实现页卡标题效果" class="headerlink" title="使用PagerTabStrip和PagerTitleStrip实现页卡标题效果"></a>使用PagerTabStrip和PagerTitleStrip实现页卡标题效果</h3><p>仅需稍稍修改上一节中的部分内容，即可实现页卡标题效果，具体修改如下：<br>1、在main.xml布局文件中的ViewPager控件中声明PagerTabStrip和PagerTitleStrip子控件<br>PagerTabStrip和PagerTitleStrip都是ViewPager控件的子控件<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;LinearLayout ...&gt;</div><div class="line"></div><div class="line">    &lt;android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.view</span><span class="selector-class">.ViewPager</span></div><div class="line">        ...同上一节中的的属性设置&gt;</div><div class="line">        </div><div class="line">        &lt;!-- PagerTabStrip是ViewPager的子控件 --&gt;</div><div class="line">        &lt;android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.view</span><span class="selector-class">.PagerTabStrip</span></div><div class="line">            android:id=<span class="string">"@+id/tab"</span></div><div class="line">            android:layout_width=<span class="string">"wrap_content"</span></div><div class="line">            android:layout_height=<span class="string">"wrap_content"</span></div><div class="line">            android:layout_gravity=<span class="string">"top"</span>&gt;</div><div class="line">        &lt;/android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.view</span><span class="selector-class">.PagerTabStrip</span>&gt;</div><div class="line">        </div><div class="line">        &lt;!-- PagerTitleStrip是ViewPager的子控件，与 PagerTabStrip不可同时出现,本例是为了说明用法，才放于同一布局文件中--&gt;</div><div class="line">        &lt;android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.view</span><span class="selector-class">.PagerTitleStrip</span></div><div class="line">            android:id=<span class="string">"@+id/tab"</span></div><div class="line">            android:layout_width=<span class="string">"wrap_content"</span></div><div class="line">            android:layout_height=<span class="string">"wrap_content"</span></div><div class="line">            android:layout_gravity=<span class="string">"bottom"</span>&gt;</div><div class="line">        &lt;/android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.view</span><span class="selector-class">.PagerTitleStrip</span>&gt;</div><div class="line"></div><div class="line">    &lt;/android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.view</span><span class="selector-class">.ViewPager</span>&gt;</div><div class="line">        </div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure></p>
<p>2、同上一节<br>3、在自定义PagerAdapter适配器子类MyPagerAdapter新增加如下代码<br>其他代码同上一节<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyPagerAdapter</span> <span class="keyword">extends</span> <span class="title">PagerAdapter</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//声明页卡标题对象</span></div><div class="line">    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">String</span>&gt; titleList;</div><div class="line">    </div><div class="line">    <span class="comment">//创建该适配器二个参数的构造方法</span></div><div class="line">    public <span class="type">MyPagerAdapter</span>(<span class="type">List</span>&lt;<span class="type">View</span>&gt; viewList,<span class="type">List</span>&lt;<span class="type">String</span>&gt; titleList)&#123;</div><div class="line">        <span class="keyword">this</span>.viewList = viewList;</div><div class="line">        <span class="keyword">this</span>.titleList = titleList;</div><div class="line">    </div><div class="line">    <span class="comment">//实现页卡标题效果时必须实现的方法——getPageTitle</span></div><div class="line">    <span class="comment">//用于返回ViewPager的页卡标题信息</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    public <span class="type">CharSequence</span> getPageTitle(int position) &#123;</div><div class="line">        <span class="comment">//position为当前页卡标题在titleList中的位置</span></div><div class="line">        <span class="keyword">return</span> titleList.get(position);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4、在MainActivity中新增如下代码<br>其他代码同上一节<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.support.v4.view.<span class="type">PagerTabStrip</span>;</div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//同上一节，代码省略</span></div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="type">PagerTabStrip</span> tab;</div><div class="line">    <span class="comment">//标题集合</span></div><div class="line">    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">String</span>&gt; titleList;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        <span class="comment">//1、编写布局文件，声明android.support.v4.view.ViewPager控件</span></div><div class="line">        <span class="comment">//同上一节，代码省略</span></div><div class="line">        </div><div class="line">        <span class="comment">//2、初始化viewList和viewPager对象</span></div><div class="line">        <span class="comment">//同上一节，代码省略</span></div><div class="line">        <span class="comment">//初始化PagerTabStrip对象</span></div><div class="line">        tab = (<span class="type">PagerTabStrip</span>)findViewById(<span class="type">R</span>.id.tab);</div><div class="line"></div><div class="line">        <span class="comment">//3、把布局文件转换为View对象</span></div><div class="line">        <span class="comment">//同上一节，代码省略</span></div><div class="line">        </div><div class="line">        <span class="comment">//4、将View对象存储到List集合中，作为ViewPager的数据源</span></div><div class="line">        <span class="comment">//同上一节，代码省略</span></div><div class="line">        </div><div class="line">        <span class="comment">//为PagerTabStrip设置一些显示效果</span></div><div class="line">        tab.setBackgroundColor(<span class="type">Color</span>.<span class="type">YELLOW</span>);</div><div class="line">        tab.setTextColor(<span class="type">Color</span>.<span class="type">RED</span>);</div><div class="line">        tab.setDrawFullUnderline(<span class="literal">false</span>);<span class="comment">//去掉长分隔线</span></div><div class="line">        tab.setTabIndicatorColor(<span class="type">Color</span>.<span class="type">GREEN</span>);<span class="comment">//更改短分隔线的颜色</span></div><div class="line">        <span class="comment">//为ViewPager页卡设置标题</span></div><div class="line">        titleList = <span class="keyword">new</span> <span class="type">ArrayList</span>&lt;<span class="type">String</span>&gt;();</div><div class="line">        titleList.add(<span class="string">"首页"</span>);</div><div class="line">        titleList.add(<span class="string">"要闻"</span>);</div><div class="line">        titleList.add(<span class="string">"图片"</span>);</div><div class="line">        titleList.add(<span class="string">"活动"</span>);</div><div class="line">        </div><div class="line">        <span class="comment">//5、自定义PagerAdapter适配器子类MyPagerAdapter</span></div><div class="line">        </div><div class="line">        <span class="comment">//6、实例化PagerAdapter适配器子类MyPagerAdapter对象</span></div><div class="line">        <span class="comment">//使用MyPagerAdapter的第二个构成方法</span></div><div class="line">        <span class="type">MyPagerAdapter</span> ad = <span class="keyword">new</span> <span class="type">MyPagerAdapter</span>(viewList,titleList);</div><div class="line">        </div><div class="line">        <span class="comment">//7、为ViewPager加载适配器</span></div><div class="line">        <span class="comment">//同上一节，代码省略</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5、使用PagerTitleStrip控件时，只需在上一步的基础上，修改一下tab对象的类型为PagerTitleStrip即可，具体修改如下：<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//private PagerTabStrip <span class="built_in">tab</span>;</div><div class="line">private PagerTitleStrip <span class="built_in">tab</span>;</div><div class="line"></div><div class="line">//<span class="built_in">tab</span> = (PagerTabStrip)findViewById(R.id.<span class="built_in">tab</span>);</div><div class="line"><span class="built_in">tab</span> = (PagerTitleStrip)findViewById(R.id.<span class="built_in">tab</span>);</div><div class="line"></div><div class="line">//<span class="built_in">tab</span>.setDrawFullUnderline(<span class="literal">false</span>);//去掉长分隔线</div><div class="line">//<span class="built_in">tab</span>.setTabIndicatorColor(Color.GREEN);//更改短分隔线的颜色</div></pre></td></tr></table></figure></p>
<h3 id="使用ViewPager的步骤——使用FragmentPagerAdapter的子类适配器"><a href="#使用ViewPager的步骤——使用FragmentPagerAdapter的子类适配器" class="headerlink" title="使用ViewPager的步骤——使用FragmentPagerAdapter的子类适配器"></a>使用ViewPager的步骤——使用FragmentPagerAdapter的子类适配器</h3><p>注: 使用的Fragment及FragmentPagerAdapter、FragmentStatePagerAdapter等全部都是android.support.v4包中的，为了保持与Fragment的兼容性</p>
<p>1、在xml布局文件中声明ViewPager控件，命名为main.xml<br>内容与“使用ViewPager的步骤——使用View对象作为ViewPager的数据源”中的main.xml完全相同<br>2、声明4个用于左右滑动的视图布局文件<br>内容与“使用ViewPager的步骤——使用View对象作为ViewPager的数据源”中的view.xml,view2.xml,view3.xml,view4.xml完全相同<br>3、创建四个类MyFragment1、MyFragment2、MyFragment3、MyFragment4，均继承自<br>android.support.v4.app.Fragment<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//为在3.0以下使用fragment，导入并继承自android.support.v4.app.Fragment</span></div><div class="line"><span class="keyword">import</span> android.support.v4.app.<span class="type">Fragment</span>;</div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyFragment3</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container,</div><div class="line">            <span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">return</span> inflater.inflate(<span class="type">R</span>.layout.view, container, <span class="literal">false</span>);</div><div class="line">        <span class="comment">//其他三个android.support.v4.app.Fragment子类引用的布局文件为</span></div><div class="line">        <span class="comment">//R.layout.view2，R.layout.view3，R.layout.view4</span></div><div class="line">        <span class="comment">//其他完全相同</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4、自定义FragmentPagerAdapter的子类MyFragmentPagerAdapter<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.support.v4.app.Fragment;</div><div class="line"><span class="keyword">import</span> android.support.v4.app.FragmentManager;</div><div class="line"><span class="keyword">import</span> android.support.v4.app.FragmentPagerAdapter;</div><div class="line"></div><div class="line"><span class="comment">//自定义FragmentPagerAdapter的子类</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFragmentPagerAdapter</span> <span class="keyword">extends</span> <span class="title">FragmentPagerAdapter</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//fragment数据源</span></div><div class="line">    <span class="keyword">private</span> List&lt;Fragment&gt; fragList;</div><div class="line">    <span class="keyword">private</span> List&lt;String&gt; titleList;</div><div class="line">    <span class="comment">//构造函数</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyFragmentPagerAdapter</span><span class="params">(FragmentManager fm,List&lt;Fragment&gt; fragList,List&lt;String&gt; titleList)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(fm);</div><div class="line">        <span class="keyword">this</span>.fragList = fragList;</div><div class="line">        <span class="keyword">this</span>.titleList = titleList;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//返回当前fragment对象</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function">Fragment <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> arg0)</span> </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="function"><span class="keyword">return</span> fragList.<span class="title">get</span><span class="params">(arg0)</span></span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="function"><span class="keyword">return</span> fragList.<span class="title">size</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//获取页卡标题的方法</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function">CharSequence <span class="title">getPageTitle</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="function"><span class="keyword">return</span> titleList.<span class="title">get</span><span class="params">(position)</span></span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5、在MainActivity中配置MyFragmentPagerAdapter<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.graphics.<span class="type">Color</span>;</div><div class="line"><span class="keyword">import</span> android.os.<span class="type">Bundle</span>;</div><div class="line"><span class="keyword">import</span> android.support.v4.app.<span class="type">Fragment</span>;</div><div class="line"><span class="keyword">import</span> android.support.v4.app.<span class="type">FragmentActivity</span>;</div><div class="line"><span class="keyword">import</span> android.support.v4.view.<span class="type">PagerTabStrip</span>;</div><div class="line"><span class="keyword">import</span> android.support.v4.view.<span class="type">ViewPager</span>;</div><div class="line"><span class="keyword">import</span> android.view.<span class="type">View</span>;</div><div class="line"></div><div class="line"><span class="comment">//为了配合v4.Fragment的兼容性,MainActivity需要继承自android.support.v4.app.FragmentActivity</span></div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">FragmentActivity</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="type">ViewPager</span> vp;</div><div class="line">    <span class="keyword">private</span> <span class="type">PagerTabStrip</span> tab;</div><div class="line">    <span class="comment">//标题集合</span></div><div class="line">    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">String</span>&gt; titleList;</div><div class="line">    </div><div class="line">    <span class="comment">//使用List&lt;Fragment&gt;对象，用于存储ViewPager的数据源</span></div><div class="line">    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">Fragment</span>&gt; fragList;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        <span class="comment">//1、编写布局文件，声明android.support.v4.view.ViewPager控件</span></div><div class="line">        setContentView(<span class="type">R</span>.layout.main);</div><div class="line">        </div><div class="line">        <span class="comment">/*</span></div><div class="line">         * 使用Fragment作为ViewPager的数据源</div><div class="line">         * */</div><div class="line"></div><div class="line">        <span class="comment">//2、初始化fragList和viewPager对象</span></div><div class="line">        fragList = <span class="keyword">new</span> <span class="type">ArrayList</span>&lt;<span class="type">Fragment</span>&gt;();</div><div class="line">        vp =  (<span class="type">ViewPager</span>) findViewById(<span class="type">R</span>.id.vp);</div><div class="line">        tab = (<span class="type">PagerTabStrip</span>)findViewById(<span class="type">R</span>.id.tab);     </div><div class="line">        </div><div class="line">        <span class="comment">//为PagerTabStrip设置一些显示效果</span></div><div class="line">        tab.setBackgroundColor(<span class="type">Color</span>.<span class="type">YELLOW</span>);</div><div class="line">        tab.setTextColor(<span class="type">Color</span>.<span class="type">RED</span>);</div><div class="line">        tab.setDrawFullUnderline(<span class="literal">false</span>);<span class="comment">//去掉长分隔线</span></div><div class="line">        tab.setTabIndicatorColor(<span class="type">Color</span>.<span class="type">GREEN</span>);<span class="comment">//更改短分隔线的颜色</span></div><div class="line">        <span class="comment">//为ViewPager页卡设置标题</span></div><div class="line">        titleList = <span class="keyword">new</span> <span class="type">ArrayList</span>&lt;<span class="type">String</span>&gt;();</div><div class="line">        titleList.add(<span class="string">"首页"</span>);</div><div class="line">        titleList.add(<span class="string">"要闻"</span>);</div><div class="line">        titleList.add(<span class="string">"图片"</span>);</div><div class="line">        titleList.add(<span class="string">"活动"</span>);</div><div class="line">        </div><div class="line">        </div><div class="line">        <span class="comment">//3、将View对象存储到fragList集合中，作为ViewPager的数据源</span></div><div class="line">        fragList.add(<span class="keyword">new</span> <span class="type">MyFragment1</span>());</div><div class="line">        fragList.add(<span class="keyword">new</span> <span class="type">MyFragment2</span>());</div><div class="line">        fragList.add(<span class="keyword">new</span> <span class="type">MyFragment3</span>());</div><div class="line">        fragList.add(<span class="keyword">new</span> <span class="type">MyFragment4</span>());</div><div class="line">        <span class="comment">//4、自定义FragmentPagerAdapter的子类数据适配器MyFragmentPagerAdapter</span></div><div class="line">        </div><div class="line">        <span class="comment">//5、配置MyFragmentPagerAdapter适配器</span></div><div class="line">        <span class="comment">//为了配合v4.Fragment的兼容性,使用getSupportFragmentManager()</span></div><div class="line">        <span class="type">MyFragmentPagerAdapter</span> fpd = <span class="keyword">new</span> <span class="type">MyFragmentPagerAdapter</span>(getSupportFragmentManager(),fragList,titleList);</div><div class="line">        <span class="comment">//6、加载MyFragmentPagerAdapter适配器对象</span></div><div class="line">        vp.setAdapter(fpd);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="使用ViewPager的步骤——使用FragmentStatePagerAdapter的子类适配器"><a href="#使用ViewPager的步骤——使用FragmentStatePagerAdapter的子类适配器" class="headerlink" title="使用ViewPager的步骤——使用FragmentStatePagerAdapter的子类适配器"></a>使用ViewPager的步骤——使用FragmentStatePagerAdapter的子类适配器</h3><p>使用FragmentStatePagerAdapter适配器与使用FragmentPagerAdapter适配器大同小异，仅需做二处修改，具体修改如下：<br>1、前三步与“使用ViewPager的步骤——使用FragmentPagerAdapter的子类适配器”一节的前三步一样<br>2、自定义FragmentStatePagerAdapter的子类MyFragmentStatePagerAdapter<br>新增instantiateItem和destroyItem方法，不需要重写<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.support.v4.app.<span class="type">FragmentStatePagerAdapter</span>;</div><div class="line"></div><div class="line"><span class="comment">//自定义FragmentStatePagerAdapter的子类</span></div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyFragmentStatePagerAdapter</span> <span class="keyword">extends</span> <span class="title">FragmentStatePagerAdapter</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//其他代码同上一节的MyFragmentPagerAdapter</span></div><div class="line">    </div><div class="line">    <span class="comment">//新增instantiateItem方法</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    public <span class="type">Object</span> instantiateItem(<span class="type">ViewGroup</span> arg0, int arg1) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.instantiateItem(arg0, arg1);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//新增destroyItem方法</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    public void destroyItem(<span class="type">ViewGroup</span> container, int position, <span class="type">Object</span> <span class="class"><span class="keyword">object</span>) </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="keyword">super</span>.destroyItem(container, position, <span class="class"><span class="keyword">object</span>)</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3、在MainActivity中配置MyFragmentStatePagerAdapter<br><figure class="highlight pony"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//其他代码同上一节的MainActivity</span></div><div class="line"></div><div class="line"><span class="comment">//4、配置MyFragmentStatePagerAdapter适配器</span></div><div class="line"><span class="type">MyFragmentStatePagerAdapter</span> fpd = <span class="function"><span class="keyword">new</span> <span class="title">MyFragmentStatePagerAdapter</span>(getSupportFragmentManager(),<span class="title">fragList</span>,<span class="title">titleList</span>);</span></div><div class="line"><span class="comment">//5、加载适配器</span></div><div class="line"><span class="title">vp</span>.<span class="title">setAdapter</span>(fpd);</div></pre></td></tr></table></figure></p>
<h3 id="ViewPager监听器OnPageChangeListener的用法"><a href="#ViewPager监听器OnPageChangeListener的用法" class="headerlink" title="ViewPager监听器OnPageChangeListener的用法"></a>ViewPager监听器OnPageChangeListener的用法</h3><p>onPageChangeListener()————用来监控ViewPager滑动到第几页<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">import android<span class="selector-class">.support</span><span class="selector-class">.v4</span><span class="selector-class">.view</span><span class="selector-class">.ViewPager</span><span class="selector-class">.OnPageChangeListener</span>;</div><div class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">MainActivity</span> <span class="selector-tag">extends</span> <span class="selector-tag">FragmentActivity</span> <span class="selector-tag">implements</span> <span class="selector-tag">OnPageChangeListener</span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//其他代码同上一节的MainActivity</span></div><div class="line"></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super<span class="selector-class">.onCreate</span>(savedInstanceState);</div><div class="line">        </div><div class="line">        <span class="comment">//其他代码同上一节的MainActivity</span></div><div class="line"></div><div class="line">        <span class="comment">//加载监听器</span></div><div class="line">        vp<span class="selector-class">.setOnPageChangeListener</span>(this);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onPageScrollStateChanged(int arg0) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onPageScrolled(int arg0, float arg1, int arg2) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//OnPageChangeListener接口中最常用的是该方法</span></div><div class="line">    <span class="variable">@Override</span></div><div class="line">    public void onPageSelected(int position) &#123;</div><div class="line">        <span class="comment">//position从0开始计数</span></div><div class="line">        Toast<span class="selector-class">.makeText</span>(this, <span class="string">"当前是第"</span>+position+<span class="string">"个页面"</span>, Toast.LENGTH_SHORT)<span class="selector-class">.show</span>();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用ViewFlipper实现屏幕自动切换动画效果"><a href="#使用ViewFlipper实现屏幕自动切换动画效果" class="headerlink" title="使用ViewFlipper实现屏幕自动切换动画效果"></a>使用ViewFlipper实现屏幕自动切换动画效果</h2><p>本质：ViewFlipper是Android系统自带的一个多页面管理控件，可以实现子界面的自动切换。</p>
<p>在ViewFlipper中导入子控件的两种方式——————静态导入与动态导入</p>
<p>1、静态导入(使用较少)<br>在layout布局文件是ViewFlipper中直接声明子控件<br>2、动态导入————使用addView()方法(使用较多)<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">flipper</span> = (ViewFlipper) findViewById(R.id.flipper)<span class="comment">;</span></div><div class="line">flipper.addView(R.drawable.pic1)<span class="comment">;</span></div><div class="line">flipper.addView(R.drawable.pic2)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<p>ViewFlipper的常用方法<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">setInAnimation</span><span class="params">()</span></span>  设置Vieww进入屏幕时使用的动画</div><div class="line">setOutAnimation   设置Vieww退出屏幕时使用的动画</div><div class="line"><span class="function"><span class="title">showNext</span><span class="params">()</span></span>        调用该函数来显示ViewFlipper里面的下一个View</div><div class="line"><span class="function"><span class="title">showPrevious</span><span class="params">()</span></span>    调用该函数来显示ViewFlipper里面的上一个View</div><div class="line"><span class="function"><span class="title">setFilpInterval</span><span class="params">()</span></span> 设置View之间切换的时间间隔</div><div class="line"><span class="function"><span class="title">startFlipping</span><span class="params">()</span></span>   使用上面设置的时间间隔来开始切换所有的View，切换会循环进行</div><div class="line"><span class="function"><span class="title">stopFlipping</span><span class="params">()</span></span>    停止View切换</div></pre></td></tr></table></figure></p>
<h3 id="使用ViewFlipper实现屏幕自动切换动画效果的步骤"><a href="#使用ViewFlipper实现屏幕自动切换动画效果的步骤" class="headerlink" title="使用ViewFlipper实现屏幕自动切换动画效果的步骤"></a>使用ViewFlipper实现屏幕自动切换动画效果的步骤</h3><p>1、在布局文件中声明ViewFlipper控件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ViewFlipper</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/flipper"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">        &gt;<span class="tag">&lt;/<span class="name">ViewFlipper</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、在MainActivity中实现屏幕自动切换动画效果<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="type">ViewFlipper</span> vf;</div><div class="line">    <span class="comment">//子view的资源id数组</span></div><div class="line">    <span class="keyword">private</span> int[]resId = &#123;<span class="type">R</span>.drawable.pic1,<span class="type">R</span>.drawable.pic2,<span class="type">R</span>.drawable.pic3,<span class="type">R</span>.drawable.pic4&#125;;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(<span class="type">R</span>.layout.activity_main);</div><div class="line">        </div><div class="line">        <span class="comment">//动态导入的方式为ViewFlipper加入子View</span></div><div class="line">        </div><div class="line">        <span class="comment">//1、初始化ViewFlipper对象</span></div><div class="line">        vf = (<span class="type">ViewFlipper</span>) findViewById(<span class="type">R</span>.id.flipper);</div><div class="line">        </div><div class="line">        <span class="comment">//2、遍历子view的资源id数组</span></div><div class="line">        <span class="keyword">for</span>(int i=<span class="number">0</span>;i&lt;resId.length;i++)&#123;</div><div class="line">            </div><div class="line">            <span class="comment">//3、动态导入的方式为ViewFlipper加入子View</span></div><div class="line">            vf.addView(getImageView(resId[i]));</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">//5、为ViewFlipper设置自动切换动画效果</span></div><div class="line">        vf.setInAnimation(<span class="keyword">this</span>,<span class="type">R</span>.anim.left_in);<span class="comment">//left_in为自定义的动画效果</span></div><div class="line">        vf.setOutAnimation(<span class="keyword">this</span>, <span class="type">R</span>.anim.left_out);<span class="comment">//left_out为自定义的动画效果</span></div><div class="line">        vf.setFlipInterval(<span class="number">3000</span>);<span class="comment">//设置视图切换时间间隔</span></div><div class="line">        vf.startFlipping();<span class="comment">//开始播放动画</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//4、实现通过子view的资源id数组索引来获取子view对象</span></div><div class="line">    <span class="keyword">private</span> <span class="type">ImageView</span> getImageView(int resId) &#123;</div><div class="line">        <span class="type">ImageView</span> iv = <span class="keyword">new</span> <span class="type">ImageView</span>(<span class="keyword">this</span>);</div><div class="line">        <span class="comment">//下面的方法无法显示全屏显示图片的效果</span></div><div class="line">        <span class="comment">//iv.setImageResource(resId);</span></div><div class="line">        </div><div class="line">        <span class="comment">//全屏显示图片</span></div><div class="line">        iv.setBackgroundResource(resId);</div><div class="line">        <span class="keyword">return</span> iv;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="支持手势滑动的ViewFlipper"><a href="#支持手势滑动的ViewFlipper" class="headerlink" title="支持手势滑动的ViewFlipper"></a>支持手势滑动的ViewFlipper</h3><p>只要是在MainActivity中添加支持手势的函数onTouchEvent,该函数监控手势滑动的事件处理，具体代码如下<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> ViewFlipper vf;</div><div class="line">    <span class="comment">//子view的资源id数组</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[]resId = &#123;R.drawable.pic1,R.drawable.pic2,R.drawable.pic3,R.drawable.pic4&#125;;</div><div class="line">   </div><div class="line">    <span class="comment">//记录手指落下的x轴位置</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> startX;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">        </div><div class="line">        <span class="comment">//动态导入的方式为ViewFlipper加入子View</span></div><div class="line">        </div><div class="line">        <span class="comment">//1、初始化ViewFlipper对象</span></div><div class="line">        vf = (ViewFlipper) findViewById(R.id.flipper);</div><div class="line">        </div><div class="line">        <span class="comment">//2、遍历子view的资源id数组</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;resId.length;i++)&#123;</div><div class="line">            <span class="comment">//3、动态导入的方式为ViewFlipper加入子View</span></div><div class="line">            vf.addView(getImageView(resId[i]));</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//4、实现通过子view的资源id数组索引来获取子view对象</span></div><div class="line">    <span class="keyword">private</span> <span class="function">ImageView <span class="title">getImageView</span><span class="params">(<span class="keyword">int</span> resId)</span> </span>&#123;</div><div class="line">        ImageView iv = <span class="keyword">new</span> ImageView(<span class="keyword">this</span>);</div><div class="line">        <span class="comment">//下面的方法无法显示全屏显示图片的效果</span></div><div class="line">        <span class="comment">//iv.setImageResource(resId);</span></div><div class="line">        </div><div class="line">        <span class="comment">//全屏显示图片</span></div><div class="line">        iv.setBackgroundResource(resId);</div><div class="line">        <span class="keyword">return</span> iv;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//5、为ViewFlipper设置根据手势切换动画效果</span></div><div class="line">    <span class="comment">//添加支持手势的函数onTouchEvent,该函数监控手势滑动的事件处理</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        </div><div class="line">        <span class="keyword">switch</span>(event.getAction())&#123;</div><div class="line">            <span class="comment">//手指落下</span></div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:&#123;</div><div class="line">                startX = event.getX();<span class="comment">//获取X轴的位置</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//手指滑动</span></div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:&#123;</div><div class="line">                <span class="comment">//向右滑动,查看前一页</span></div><div class="line">                <span class="keyword">if</span>(event.getX()-startX&gt;<span class="number">100</span>)&#123;</div><div class="line">                    vf.setInAnimation(<span class="keyword">this</span>, R.anim.left_in);</div><div class="line">                    vf.setInAnimation(<span class="keyword">this</span>, R.anim.left_out);</div><div class="line">                    vf.showPrevious();<span class="comment">//显示前一页</span></div><div class="line">                &#125;</div><div class="line">                <span class="comment">//向左滑动,显示后一页</span></div><div class="line">                <span class="keyword">if</span>(startX-event.getX()&gt;<span class="number">100</span>)&#123;</div><div class="line">                    vf.setInAnimation(<span class="keyword">this</span>, R.anim.right_in);</div><div class="line">                    vf.setInAnimation(<span class="keyword">this</span>, R.anim.right_out);</div><div class="line">                    vf.showNext();<span class="comment">//显示后一页</span></div><div class="line">                &#125;</div><div class="line">                <span class="comment">//其他情况认为是微小滑动，不执行操作</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//手指离开屏幕</span></div><div class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:&#123;</div><div class="line">                <span class="comment">//不需要执行任何操作</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">return</span> <span class="keyword">super</span>.<span class="title">onTouchEvent</span><span class="params">(event)</span></span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用ScrollView实现滚动效果"><a href="#使用ScrollView实现滚动效果" class="headerlink" title="使用ScrollView实现滚动效果"></a>使用ScrollView实现滚动效果</h2><p>ScrollView(滚动视图)是指当屏幕拥有很多内容，一屏显示不完时，需要通过滚动来显示完成的视图</p>
<p>ScrollView的2个分类：<br>    HorizontalScrollView ———— 水平滚动视图<br>    ScrollView ———— 垂直滚动视图</p>
<p>隐藏ScrollView的滚动条方法<br>    标签属性：android:scrollbars=”none”<br>    代码设置：<br>        setHorizontalScrollBarEnabled(false); //隐藏水平ScrollView<br>        setVerticalScrollBarEnabled(false); //隐藏垂直ScrollView</p>
<h3 id="使用ScrollView可以实现滚动效果的步骤"><a href="#使用ScrollView可以实现滚动效果的步骤" class="headerlink" title="使用ScrollView可以实现滚动效果的步骤"></a>使用ScrollView可以实现滚动效果的步骤</h3><p>1、在布局文件中声明ScrollView控件，将将要滚动的视图如TextView作为其子控件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ScrollView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/scroll"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:scrollbars</span>=<span class="string">"none"</span>&gt;</div><div class="line">        </div><div class="line">        <span class="tag">&lt;<span class="name">TextView</span> </span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/tv"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> /&gt;</div><div class="line">    </div><div class="line">    <span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、在MainActivity中使用ScrollView实现滚动效果<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">OnClickListener</span>&#123;</span></div><div class="line">    </div><div class="line">    <span class="keyword">private</span> TextView tv;</div><div class="line">    <span class="keyword">private</span> Button up,down;</div><div class="line">    <span class="keyword">private</span> ScrollView scroll;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">        </div><div class="line">        <span class="comment">//1、获取将要滚动的视图如TextView</span></div><div class="line">        tv = (TextView) findViewById(R.id.tv);</div><div class="line">        <span class="comment">//2、设置长文本</span></div><div class="line">        tv.setText(getResources().getString(R.string.longCon));</div><div class="line">        <span class="comment">//getResources().getString(R.string.longCon)的作用是</span></div><div class="line">        <span class="comment">//获取res文件夹下的string.xml文件中的longCon标签的内容</span></div><div class="line"></div><div class="line">        <span class="comment">//3、为ScrollView设置监听器setOnTouchListener()</span></div><div class="line">        <span class="comment">//判断ScrollView滑动到底部的公式:视图的总高度&lt;=一屏幕的高度+滚动条滚动的距离</span></div><div class="line">        scroll.setOnTouchListener(<span class="keyword">new</span> OnTouchListener() &#123;</div><div class="line">            </div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="keyword">public</span> <span class="keyword">boolean</span> onTouch(View v, MotionEvent event) &#123;</div><div class="line">                </div><div class="line">                <span class="keyword">switch</span>(event.getAction())&#123;</div><div class="line">                    <span class="keyword">case</span> MotionEvent.<span class="string">ACTION_UP:</span>&#123;</div><div class="line">                        <span class="comment">//手指落下事件，本例中不做处理</span></div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">case</span> MotionEvent.<span class="string">ACTION_DOWN:</span>&#123;</div><div class="line">                        <span class="comment">//手指离开事件，本例中不做处理</span></div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="comment">//手指移动事件</span></div><div class="line">                    <span class="keyword">case</span> MotionEvent.<span class="string">ACTION_MOVE:</span>&#123;</div><div class="line">                        <span class="comment">/*</span></div><div class="line">                         * 1、getScrollY()——————滚动条滑动的距离</div><div class="line">                         * 2、getMeasuredHeight()————视图的总高度(包括屏幕外的部分)</div><div class="line">                         * 3、getHeight()————一屏幕的高度</div><div class="line">                         * </div><div class="line">                         */</div><div class="line">                        </div><div class="line">                        <span class="comment">//处于顶部状态</span></div><div class="line">                        <span class="keyword">if</span>(scroll.getScrollY()&lt;=<span class="number">0</span>)&#123;</div><div class="line">                            Log.i(<span class="string">"Main"</span>,<span class="string">"处于顶部"</span>);</div><div class="line">                        &#125;</div><div class="line">                        </div><div class="line">                        <span class="comment">//底部状态</span></div><div class="line">                        <span class="comment">//TextView的总高度&lt;=一屏幕的高度+滚动条滚动的距离</span></div><div class="line">                        <span class="keyword">if</span>(scroll.getChildAt(<span class="number">0</span>).getMeasuredHeight()&lt;=scroll.getHeight()+scroll.getScrollY())&#123;</div><div class="line">                            Log.i(<span class="string">"Main"</span>,<span class="string">"滑到底部"</span>);</div><div class="line">                            Log.i(<span class="string">"Main"</span>,<span class="string">"scroll.getChildAt(0).getMeasuredHeight()="</span>+scroll.getChildAt(<span class="number">0</span>).getMeasuredHeight());</div><div class="line">                            Log.i(<span class="string">"Main"</span>,<span class="string">"scroll.getHeight()="</span>+scroll.getHeight());</div><div class="line">                            Log.i(<span class="string">"Main"</span>,<span class="string">"scroll.getScrollY()="</span>+scroll.getScrollY());</div><div class="line">                            </div><div class="line">                            <span class="comment">//追加文本</span></div><div class="line">                            tv.append(<span class="string">"这是一段追加文本"</span>);</div><div class="line">                        &#125;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        <span class="comment">//为button添加click事件监听器，说明scrollTo与scrollBy的区别</span></div><div class="line">        up = (Button) findViewById(R.id.up);</div><div class="line">        down = (Button) findViewById(R.id.down);</div><div class="line">        </div><div class="line">        up.setOnClickListener(<span class="keyword">this</span>);</div><div class="line">        down.setOnClickListener(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> onClick(View v) &#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        <span class="keyword">switch</span>(v.getId())&#123;</div><div class="line">            <span class="comment">//scrollTo()————参考滚动条最开始的位置，只能滚动一次</span></div><div class="line">            <span class="comment">//scrollBy()————相对滚动条前一次的位置进行滚动，可以实现持续滚动</span></div><div class="line">            <span class="keyword">case</span> R.id.<span class="string">up:</span>&#123;</div><div class="line">                scroll.scrollTo(<span class="number">0</span>,<span class="number">-30</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">case</span> R.id.<span class="string">down:</span>&#123;</div><div class="line">                scroll.scrollBy(<span class="number">0</span>,<span class="number">30</span>);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用Gallery和ImageSwitcher制作图片浏览器"><a href="#使用Gallery和ImageSwitcher制作图片浏览器" class="headerlink" title="使用Gallery和ImageSwitcher制作图片浏览器"></a>使用Gallery和ImageSwitcher制作图片浏览器</h2><p>Gallery: android提供的一种可通过手机触摸来移动图片，产生图片滚动效果，还可以响应其他事件。</p>
<p>通过Gallery在UI上实现缩略图浏览器，通过ImageSwitcher显示预览大图。</p>
<p>1、在布局文件中声明了Gallery控件和ImageSwitcher控件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Gallery</span> </span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/gallery"</span>/&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ImageSwitcher</span> </span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/imgsw"</span>&gt;<span class="tag">&lt;/<span class="name">ImageSwitcher</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、编写继承自BaseAdapter的自定义适配器MyImageAdapter<br>BaseAdapter中重要方法<br>    public int getCount()  ————返回已定义的数据源的总数量<br>    public Obejct getItem(int position)<br>    public long getItem(int position)<br>            ————告诉适配器取得目前容器中的数据ID和对象<br>    public View getView(int position,View convertView,ViewGroup parent)<br>            ————取得目前欲显示的图像View，传入数组ID值使之读取与成像</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImageAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//数据源</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[]res;</div><div class="line">    <span class="comment">//上下文</span></div><div class="line">    <span class="keyword">private</span> Context context;</div><div class="line">    <span class="comment">//定义构造方法，传递数据源</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyImageAdapter</span><span class="params">(<span class="keyword">int</span>[] res,Context context)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.res = res;</div><div class="line">        <span class="keyword">this</span>.context = context;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//返回已定义的数据源的总数量</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">//返回res.length无法实现图片无限循环滚动显示</span></div><div class="line">        <span class="comment">//return res.length;</span></div><div class="line">        <span class="comment">//为实现图片无限循环滚动显示，需返回最大值</span></div><div class="line">        <span class="keyword">return</span> Integer.MAX_VALUE;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="comment">//告诉适配器取得目前容器中的数据对象</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> res[position];</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//告诉适配器取得目前容器中的数据ID</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> position;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//取得目前欲显示的图像View，传入数组ID值使之读取与成像</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</div><div class="line">        </div><div class="line">        ImageView img = <span class="keyword">new</span> ImageView(context);</div><div class="line">        <span class="comment">//直接取数据源的下标，无法实现图片无限循环滚动显示</span></div><div class="line">        <span class="comment">//img.setBackgroundResource(res[position]);</span></div><div class="line">        <span class="comment">//为实现图片无限循环滚动显示，需进行取余操作，因position因getCount()返回无限大，res.length为12</span></div><div class="line">        img.setBackgroundResource(res[position%res.length]);</div><div class="line">        <span class="comment">//设置图片在Gallery中缩略图的大小为200*150</span></div><div class="line">        img.setLayoutParams(<span class="keyword">new</span> Gallery.LayoutParams(<span class="number">200</span>, <span class="number">150</span>));</div><div class="line">        <span class="comment">//设置image的缩略模式</span></div><div class="line">        img.setScaleType(ScaleType.FIT_XY);</div><div class="line">        <span class="keyword">return</span> img;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3、在MainActivity中实现手机触摸移动图片、大图预览效果<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">ViewFactory</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//官方建议使用HorizontalScrollView或android.support.v4.view.ViewPager替换Gallery</span></div><div class="line">    <span class="keyword">private</span> Gallery gall;</div><div class="line">    <span class="keyword">private</span> ImageSwitcher imgsw;</div><div class="line"></div><div class="line">    <span class="comment">//2、定义图片资源数据源</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] imgsId = &#123;R.drawable.item1,R.drawable.item2,R.drawable.item3,</div><div class="line">            R.drawable.item4,R.drawable.item5,R.drawable.item6,R.drawable.item7,</div><div class="line">            R.drawable.item8,R.drawable.item9,R.drawable.item10,</div><div class="line">            R.drawable.item11,R.drawable.item12&#125;;</div><div class="line"></div><div class="line">    <span class="comment">//声明自定义的适配器对象</span></div><div class="line">    <span class="keyword">private</span> MyImageAdapter adapter;</div><div class="line">    </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">        </div><div class="line">        <span class="comment">//1、初始化Gallery和ImageSwitcher对象</span></div><div class="line">        gall = (Gallery) findViewById(R.id.gallery);</div><div class="line">        imgsw = (ImageSwitcher) findViewById(R.id.imgsw);</div><div class="line">        </div><div class="line">        <span class="comment">//3、为Gallery对象加载自定义适配器</span></div><div class="line">        adapter = <span class="keyword">new</span> MyImageAdapter(imgsId,<span class="keyword">this</span>);</div><div class="line">        gall.setAdapter(adapter);</div><div class="line">        </div><div class="line">        <span class="comment">//4、为ImageSwitcher对象设置监听器，显示大图预览</span></div><div class="line">        imgsw.setFactory(<span class="keyword">this</span>);</div><div class="line">        <span class="comment">//为ImageSwitcher对象设置动画效果</span></div><div class="line">        imgsw.setInAnimation(AnimationUtils.loadAnimation(<span class="keyword">this</span>, android.R.anim.fade_in));</div><div class="line">        imgsw.setOutAnimation(AnimationUtils.loadAnimation(<span class="keyword">this</span>, android.R.anim.fade_out));</div><div class="line"></div><div class="line">        <span class="comment">//6、为Gallery设置监听器onItemSelected,实现大图预览当前选中的图片</span></div><div class="line">        gall.setOnItemSelectedListener(<span class="keyword">new</span> OnItemSelectedListener() &#123;</div><div class="line">            </div><div class="line">            <span class="comment">//7、在Gallery对象中选中图片，利用ImageSwitcher实现显示大图预览</span></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemSelected</span><span class="params">(AdapterView&lt;?&gt; parent, View view,</span></span></div><div class="line">                    <span class="keyword">int</span> position, <span class="keyword">long</span> id) &#123;</div><div class="line">                <span class="comment">//8、为ImageSwitcher对象加载图像资源</span></div><div class="line">                imgsw.setBackgroundResource(imgsId[position%imgsId.length]);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNothingSelected</span><span class="params">(AdapterView&lt;?&gt; parent)</span> </span>&#123;</div><div class="line">                </div><div class="line">            &#125;</div><div class="line">        &#125;);  </div><div class="line">    &#125;</div><div class="line">    <span class="comment">//5、为ImageSwitcher对象定义监听器的实现</span></div><div class="line">    <span class="comment">//ImageSwitcher粗略的理解就是ImageView的选择器，它需要实现ViewFactory接口</span></div><div class="line">    <span class="comment">//一般情况下，让该ViewFactory接口的makeView()方法返回ImageView对象</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">makeView</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">        ImageView img = <span class="keyword">new</span> ImageView(<span class="keyword">this</span>);</div><div class="line">        <span class="comment">//按比例缩放图片，并居中显示</span></div><div class="line">        img.setScaleType(ScaleType.FIT_CENTER);</div><div class="line">        <span class="keyword">return</span> img;</div><div class="line">    &#125;   </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使用SeekBar制作可拖动的进度条"><a href="#使用SeekBar制作可拖动的进度条" class="headerlink" title="使用SeekBar制作可拖动的进度条"></a>使用SeekBar制作可拖动的进度条</h2><p>SeekBar可以通过滑块的位置来标识数值，而且允许用户拖动滑块来改变进度值的大小</p>
<p>SeekBar的主要属性和方法<br>    setMax        设置SeekBar的最大数值<br>    setProgress   设置SeekBar当前的数值<br>    setSecondaryProgress 设置SeekBar的第二数值，即当前拖动条推荐的数值</p>
<p>SeekBar是ProgressBar的子类</p>
<p>SeekBar的事件<br>    由于拖动条可以被用户控制，所有需要对其进行事件监听，这就需要实现SeekBar.OnSeekBarChangeListener接口。此接口共需要监听三个事件，分别是：<br>        数值改变————onProgressChanged<br>        开始拖动————onStartTrackingTouch<br>        停止拖动————onStopTrackingTouch</p>
<h3 id="自定义SeekBar进度条样式————与ProgressBar类似"><a href="#自定义SeekBar进度条样式————与ProgressBar类似" class="headerlink" title="自定义SeekBar进度条样式————与ProgressBar类似"></a>自定义SeekBar进度条样式————与ProgressBar类似</h3><pre><code>查看SeekBar默认的样式style=&quot;@android:style/Widget.SeekBar&quot;
</code></pre><p>修改自定义SeekBar进度条样式的步骤<br>1、在drawable中编写thumb.xml文件,代码如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/select"</span> <span class="attr">android:state_pressed</span>=<span class="string">"true"</span> <span class="attr">android:state_window_focused</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/select"</span> <span class="attr">android:state_focused</span>=<span class="string">"true"</span> <span class="attr">android:state_window_focused</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/select"</span> <span class="attr">android:state_selected</span>=<span class="string">"true"</span> <span class="attr">android:state_window_focused</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:drawable</span>=<span class="string">"@drawable/normal"</span>/&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、在主布局文件中修改SeekBar的如下属性即可<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;SeekBar</div><div class="line">    ...</div><div class="line">    <span class="comment">//改变进度条的样式</span></div><div class="line">    android:progressDrawable = <span class="string">"@drawable/seekbar_img"</span></div><div class="line">    <span class="comment">//改变滑块的样式</span></div><div class="line">    android:thumb = <span class="string">"@drawable/thumb"</span>&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">SeekBar</span>&gt;</span></span></div></pre></td></tr></table></figure></p>
<h3 id="使用SeekBar制作可拖动的进度条的步骤"><a href="#使用SeekBar制作可拖动的进度条的步骤" class="headerlink" title="使用SeekBar制作可拖动的进度条的步骤"></a>使用SeekBar制作可拖动的进度条的步骤</h3><p>1、在布局文件中声明SeekBar控件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- </span></div><div class="line">            android:max="100"  //最大进度值</div><div class="line">            android:progress="50"  //当前进度值</div><div class="line">     --&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">SeekBar</span> </span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/seekbar"</span></div><div class="line">        <span class="attr">android:max</span>=<span class="string">"100"</span></div><div class="line">        <span class="attr">android:progress</span>=<span class="string">"50"</span>/&gt;</div><div class="line">    </div><div class="line">     <span class="comment">&lt;!--用于显示进度值的2个TextView--&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">TextView</span> </span></div><div class="line">         <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">         <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">         <span class="attr">android:id</span>=<span class="string">"@+id/tv1"</span>/&gt;</div><div class="line">     </div><div class="line">     <span class="tag">&lt;<span class="name">TextView</span> </span></div><div class="line">         <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">         <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">         <span class="attr">android:id</span>=<span class="string">"@+id/tv2"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、在MainActivity中使用SeekBar<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">MainActivity</span> <span class="selector-tag">extends</span> <span class="selector-tag">Activity</span> &#123;</div><div class="line"></div><div class="line">    private SeekBar sb;</div><div class="line">    private TextView tv1,tv2;</div><div class="line">    <span class="variable">@Override</span></div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super<span class="selector-class">.onCreate</span>(savedInstanceState);</div><div class="line">        setContentView(R<span class="selector-class">.layout</span><span class="selector-class">.activity_main</span>);</div><div class="line">        </div><div class="line">        <span class="comment">//1、初始化</span></div><div class="line">        sb = (SeekBar) findViewById(R<span class="selector-class">.id</span><span class="selector-class">.seekbar</span>);</div><div class="line">        tv1 = (TextView) findViewById(R<span class="selector-class">.id</span><span class="selector-class">.tv1</span>);</div><div class="line">        tv2 = (TextView) findViewById(R<span class="selector-class">.id</span><span class="selector-class">.tv2</span>);</div><div class="line">        </div><div class="line">        <span class="comment">//2、绑定事件监听器</span></div><div class="line">        <span class="selector-tag">sb</span><span class="selector-class">.setOnSeekBarChangeListener</span>(new OnSeekBarChangeListener() &#123;</div><div class="line">            </div><div class="line">            <span class="comment">//停止拖动时调用该方法</span></div><div class="line">            <span class="variable">@Override</span></div><div class="line">            public void onStopTrackingTouch(SeekBar seekBar) &#123;</div><div class="line">                tv1<span class="selector-class">.setText</span>(<span class="string">"停止拖动"</span>);</div><div class="line">                </div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">//开始拖动时调用该方法</span></div><div class="line">            <span class="variable">@Override</span></div><div class="line">            public void onStartTrackingTouch(SeekBar seekBar) &#123;</div><div class="line">                tv1<span class="selector-class">.setText</span>(<span class="string">"开始拖动"</span>);</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="comment">//数值改变时调用该方法</span></div><div class="line">            <span class="variable">@Override</span></div><div class="line">            public void onProgressChanged(SeekBar seekBar, int progress,</div><div class="line">                    boolean fromUser) &#123;</div><div class="line">                tv1<span class="selector-class">.setText</span>(<span class="string">"正在拖动"</span>);</div><div class="line">                <span class="comment">//显示当前数值</span></div><div class="line">                tv2<span class="selector-class">.setText</span>(<span class="string">"当前数值为"</span>+progress);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Android布局优化"><a href="#Android布局优化" class="headerlink" title="Android布局优化"></a>Android布局优化</h2><h3 id="推荐使用布局"><a href="#推荐使用布局" class="headerlink" title="推荐使用布局"></a>推荐使用布局</h3><p>一、Android五种常用布局<br>|    布局名称     |    特点| 使用频率|<br>| :——-:|:——–:|:——–:|:————–|<br>|    LinearLayout    |线性  垂直 水平|  4|<br>|    RelativeLayout  |最灵活的   相对定位|  5(最多)|<br> |   TableLayout     |行列，建议使用GridView代替|  2|<br>|    AbsoluteLayout  |不建议使用，兼容性差|      1(最少)|<br>|    FrameLayout     |布局叠加时使用，且该布局下的组件也都会叠加显示|  3|</p>
<p>二、Android布局原则</p>
<pre><code>1、尽量多使用LinearLayout和RelativeLayout，不要使用AbsoluteLayout。
2、在布局层次一样的情况下，建议使用LinearLayout代替RelativeLayout，
   因为LinearLayout性能稍高一点。
3、将可复用的组件抽取出来并通过include标签使用。
4、使用ViewStub标签来加载一些不常用的布局。
5、使用merge标签减少布局的嵌套层次。
</code></pre><h3 id="布局优化之include"><a href="#布局优化之include" class="headerlink" title="布局优化之include"></a>布局优化之include</h3><p>作用：将共用的组件抽取出来单独放到一个xml文件中，然后使用include标签导入共用布局<br>效果：提高UI的制作和复用效率，也能保证制作的UI布局更加规整和易维护；</p>
<p>使用inculde进行布局优化的步骤:</p>
<p>1、定义共用组件，如命名为common_title.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">    <span class="attr">android:background</span>=<span class="string">"#000000"</span> </div><div class="line">    <span class="attr">android:paddingTop</span>=<span class="string">"10dp"</span></div><div class="line">    <span class="attr">android:paddingBottom</span>=<span class="string">"10dp"</span>&gt;</div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 公共标题组件 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/ret"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"返回"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:textSize</span>=<span class="string">"14sp"</span></div><div class="line">        <span class="attr">android:textColor</span>=<span class="string">"#ffffff"</span></div><div class="line">        <span class="attr">android:layout_alignParentLeft</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:layout_marginLeft</span>=<span class="string">"10dp"</span></div><div class="line">        <span class="attr">android:layout_centerVertical</span>=<span class="string">"true"</span>/&gt;</div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/title"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"布局优化"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:textSize</span>=<span class="string">"18sp"</span></div><div class="line">        <span class="attr">android:layout_centerInParent</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:textColor</span>=<span class="string">"#ffffff"</span>/&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/fun"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"功能"</span></div><div class="line">        <span class="attr">android:layout_alignParentRight</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:layout_marginRight</span>=<span class="string">"10dp"</span></div><div class="line">        <span class="attr">android:layout_centerVertical</span>=<span class="string">"true"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:textSize</span>=<span class="string">"14sp"</span></div><div class="line">        <span class="attr">android:textColor</span>=<span class="string">"#ffffff"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、使用include标签导入共用布局到主布局文件中,如命名为main.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 导入通用标题部分 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">include</span> </span></div><div class="line">        <span class="attr">layout</span>=<span class="string">"@layout/common_title"</span>/&gt;</div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 正文部分 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"正文内容"</span></div><div class="line">        <span class="attr">android:textSize</span>=<span class="string">"18sp"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>3、在MainActivity中，可以使用所有组件<br><figure class="highlight glsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//导入主布局文件</span></div><div class="line">setContentView(R.<span class="keyword">layout</span>.main);</div><div class="line"></div><div class="line"><span class="comment">//使用include标签导入到主布局文件中的布局，就如同主布局文件中声明的一样</span></div><div class="line"><span class="comment">//所以可以直接在MainActivity中使用common_title.xml文件中的组件</span></div><div class="line">TextView tv = (TextView)findViewById(R.id.ret)</div></pre></td></tr></table></figure></p>
<h3 id="布局优化之merge"><a href="#布局优化之merge" class="headerlink" title="布局优化之merge"></a>布局优化之merge</h3><p>作用：合并UI布局，使用该标签能降低UI布局的嵌套层次</p>
<p>使用场景一：布局根结点是FrameLayout且不需要设置background或padding等属性，可以用merge代替<br>使用场景二：某布局作为子布局被其他布局include时，使用merge当作该布局的顶节点，这样在被引入时顶节点会自动被忽略</p>
<p>使用merge进行布局优化的步骤:<br>1、定义共用布局，如命名为common_progress.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">merge</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> &gt;</div><div class="line"><span class="comment">&lt;!-- 在merge的第一种使用场景中，该merge节点是替换自没有background或padding等属性的FrameLayout布局根结点 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 在merge的第二种使用场景中，该merge节点将被忽略 --&gt;</span></div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 公共环形进度条组件 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ProgressBar</span> </span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_gravity</span>=<span class="string">"center"</span>/&gt;</div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/wait"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_gravity</span>=<span class="string">"center"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"请稍后..."</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">merge</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、使用include标签导入到主布局文件中,如命名为main.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/container"</span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> &gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 导入通用标题部分 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">include</span> </span></div><div class="line">        <span class="attr">layout</span>=<span class="string">"@layout/common_title"</span>/&gt;</div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 正文部分 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></div><div class="line">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">            <span class="attr">android:text</span>=<span class="string">"正文内容"</span></div><div class="line">            <span class="attr">android:textSize</span>=<span class="string">"18sp"</span>/&gt;</div><div class="line">        </div><div class="line">        <span class="comment">&lt;!-- merge使用场景二：某布局(如common_progress.xml)作为子布局被其他布局</span></div><div class="line">             (如当前布局文件activity_main.xml)include时，</div><div class="line">              使用merge当作该布局的顶节点，这样在被引入时顶节点会自动被忽略</div><div class="line">              (即自动忽略了common_progress.xml中的&lt;merge ...&gt;这个节点) --&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">include</span> </span></div><div class="line">            <span class="attr">layout</span>=<span class="string">"@layout/common_progress"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>3、在MainActivity中，可以使用所有组件<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//导入主布局文件</span></div><div class="line">setContentView(R.layout.main);</div><div class="line"></div><div class="line"><span class="comment">//使用include标签导入到主布局文件中的布局，就如同主布局文件中声明的一样</span></div><div class="line"><span class="comment">//所以可以直接在MainActivity中使用common_progress.xml文件中的组件</span></div><div class="line">TextView <span class="built_in">wait</span> = (TextView)findViewById(R.id.<span class="built_in">wait</span>);</div><div class="line"><span class="built_in">wait</span>.setText(<span class="string">"waiting"</span>);</div></pre></td></tr></table></figure></p>
<h3 id="布局优化之viewStub惰性加载"><a href="#布局优化之viewStub惰性加载" class="headerlink" title="布局优化之viewStub惰性加载"></a>布局优化之viewStub惰性加载</h3><p>作用：Viewstub标签同include标签一样可以用来引入一个外部布局；<br>    不同的是，Viewstub引入的布局默认不会扩张(即默认不加载外部布局文件)，既不会占用显示<br>    也不会占用位置，从而在解析layout时节省cpu和内存。</p>
<p><strong>viewStub默认不加载外部布局文件，而由人为控制何时加载————惰性加载</strong></p>
<p>使用viewStub进行布局优化的步骤:<br>1、定义惰性加载布局，如命名为common_text.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line">    </div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/common_text"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"隐藏内容"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</div><div class="line">    </div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>2、使用ViewStub标签加载外部布局common_text.xml到主布局文件中,如命名为main.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">...</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/show"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"显示隐藏外部布局"</span></div><div class="line">        <span class="attr">android:layout_gravity</span>=<span class="string">"center"</span>/&gt;</div><div class="line">    </div><div class="line">    <span class="comment">&lt;!-- 使用ViewStub惰性加载外部布局common_text.xml --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ViewStub</span> </span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/stub"</span></div><div class="line">        <span class="attr">android:layout</span>=<span class="string">"@layout/common_text"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>3、在MainActivity中，惰性加载外部布局<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="type">TextView</span> commonText;</div><div class="line">    <span class="keyword">private</span> <span class="type">Button</span> show;</div><div class="line">    <span class="keyword">private</span> <span class="type">ViewStub</span> stub;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(<span class="type">R</span>.layout.activity_main);</div><div class="line">        </div><div class="line">        stub = (<span class="type">ViewStub</span>) findViewById(<span class="type">R</span>.id.stub);</div><div class="line">        show = (<span class="type">Button</span>)findViewById(<span class="type">R</span>.id.show);</div><div class="line">        </div><div class="line">        <span class="comment">//默认不加载外部布局文件，只有在点击按钮后才开始加载外部布局</span></div><div class="line">        show.setOnClickListener(<span class="keyword">new</span> <span class="type">OnClickListener</span>() &#123;</div><div class="line">            </div><div class="line">            <span class="meta">@Override</span></div><div class="line">            public void onClick(<span class="type">View</span> v) &#123;</div><div class="line">                <span class="comment">//惰性加载加载布局，连续第二次点击按钮就会报错</span></div><div class="line">                <span class="comment">//stub.inflate();</span></div><div class="line">                <span class="comment">//惰性加载加载布局，连续多次点击按钮也会正常显示</span></div><div class="line">                stub.setVisibility(stub.<span class="type">VISIBLE</span>);</div><div class="line">                <span class="comment">//调用惰性加载布局文件中组件</span></div><div class="line">                commonText = (<span class="type">TextView</span>)findViewById(<span class="type">R</span>.id.common_text);</div><div class="line">                commonText.setText(<span class="string">"显示内容"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>1、android模拟器中的所有文件路径：<br>apk存在于Window-show view-Other-Android-File Explorer<br>2、在布局文件中声明ViewPager控件与之前的控件不同，它是android.support.v4兼容包下的一个控件<br>3、android.support.v4是谷歌为了解决当前android版本碎片化而提供的兼容性jar包，位于libs文件夹下。<br>4、android.support.v4主要目的是解决向下兼容性问题，使得高版本的控件在低版本系统中仍然可以正常使用。<br>5、PagerTabStrip和PagerTitleStrip都是ViewPager控件的子控件，二者不可以同时出现。<br>6、FragmentStatePagerAdapter与FragmentPagerAdapter适配器的区别：<br>FragmentPagerAdapter不会自动的创建和销毁页卡，一次性加载所有页卡；在页卡较少时可以使用该适配器。<br>FragmentStatePagerAdapter是自动的创建和销毁页卡，而不是一次性加载所有页卡；<br>PagerAdapter是自动的创建和销毁页卡，而不是一次性加载所有页卡；默认一次加载三个页卡。<br>7、ViewFlipper与ViewPager的用法区别：<br>通过手势的左右滑动切换视图，建议使用ViewPager；<br>ViewFlipper优点是实现子界面的自动切换；<br>8、控制scrollView视图的滚动条的位置scrollTo()与scrollBy()方法的区别：<br>scrollTo()————参考滚动条最开始的位置，只能滚动一次；<br>scrollBy()————相对滚动条前一次的位置进行滚动，可以实现持续滚动<br>9、ImageSwitcher和ImageView功能类似，都可以用于显示图片，区别在于ImageSwitcher的效果更炫，它可以指定图片切换时的动画效果<br>10、如果ctrl+左键无法打开资源文件时，可以使用如下方式查看：<br>..\sdk\platforms\android-19\data\res\drawable\资源名.xml<br>11、布局的嵌套层次：通过布局文件的outline可以查看布局的嵌套层次————每缩进一层，即是一个嵌套层次。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/android/" rel="tag">#android</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/06/learn-android-step-by-step-two/" rel="next" title="android入门二">
                <i class="fa fa-chevron-left"></i> android入门二
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/14/learn-android-step-by-step-four/" rel="prev" title="android入门四">
                android入门四 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/09/12/learn-android-step-by-step-three/"
           data-title="android入门三" data-url="https://aiolos123.github.io/2016/09/12/learn-android-step-by-step-three/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="aiolos" />
          <p class="site-author-name" itemprop="name">aiolos</p>
          <p class="site-description motion-element" itemprop="description">记录aiolos的学习成长</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Fragment基础"><span class="nav-number">1.</span> <span class="nav-text">Fragment基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Fragment设计哲学"><span class="nav-number">1.1.</span> <span class="nav-text">Fragment设计哲学</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加载Fragment的两种方式"><span class="nav-number">1.2.</span> <span class="nav-text">加载Fragment的两种方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#静态加载Fragment的四个步骤"><span class="nav-number">1.3.</span> <span class="nav-text">静态加载Fragment的四个步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动态加载Fragment的四个步骤"><span class="nav-number">1.4.</span> <span class="nav-text">动态加载Fragment的四个步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fragment生命周期"><span class="nav-number">1.5.</span> <span class="nav-text">Fragment生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Fragment生命周期各方法详解"><span class="nav-number">1.5.1.</span> <span class="nav-text">Fragment生命周期各方法详解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fragment生命周期各方法执行顺序"><span class="nav-number">1.5.2.</span> <span class="nav-text">Fragment生命周期各方法执行顺序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fragment与Activity通信"><span class="nav-number">1.6.</span> <span class="nav-text">Fragment与Activity通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Activity向Fragment传递数据——动态加载fragment"><span class="nav-number">1.6.1.</span> <span class="nav-text">Activity向Fragment传递数据——动态加载fragment</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Activity向Fragment传递数据——静态加载fragment"><span class="nav-number">1.6.2.</span> <span class="nav-text">Activity向Fragment传递数据——静态加载fragment</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fragment向Activity传递数据"><span class="nav-number">1.6.3.</span> <span class="nav-text">Fragment向Activity传递数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用ViewPager实现视图左右滑动的页卡效果"><span class="nav-number">2.</span> <span class="nav-text">使用ViewPager实现视图左右滑动的页卡效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用ViewPager的步骤——使用View对象作为ViewPager的数据源"><span class="nav-number">2.1.</span> <span class="nav-text">使用ViewPager的步骤——使用View对象作为ViewPager的数据源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用PagerTabStrip和PagerTitleStrip实现页卡标题效果"><span class="nav-number">2.2.</span> <span class="nav-text">使用PagerTabStrip和PagerTitleStrip实现页卡标题效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用ViewPager的步骤——使用FragmentPagerAdapter的子类适配器"><span class="nav-number">2.3.</span> <span class="nav-text">使用ViewPager的步骤——使用FragmentPagerAdapter的子类适配器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用ViewPager的步骤——使用FragmentStatePagerAdapter的子类适配器"><span class="nav-number">2.4.</span> <span class="nav-text">使用ViewPager的步骤——使用FragmentStatePagerAdapter的子类适配器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ViewPager监听器OnPageChangeListener的用法"><span class="nav-number">2.5.</span> <span class="nav-text">ViewPager监听器OnPageChangeListener的用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用ViewFlipper实现屏幕自动切换动画效果"><span class="nav-number">3.</span> <span class="nav-text">使用ViewFlipper实现屏幕自动切换动画效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用ViewFlipper实现屏幕自动切换动画效果的步骤"><span class="nav-number">3.1.</span> <span class="nav-text">使用ViewFlipper实现屏幕自动切换动画效果的步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#支持手势滑动的ViewFlipper"><span class="nav-number">3.2.</span> <span class="nav-text">支持手势滑动的ViewFlipper</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用ScrollView实现滚动效果"><span class="nav-number">4.</span> <span class="nav-text">使用ScrollView实现滚动效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用ScrollView可以实现滚动效果的步骤"><span class="nav-number">4.1.</span> <span class="nav-text">使用ScrollView可以实现滚动效果的步骤</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用Gallery和ImageSwitcher制作图片浏览器"><span class="nav-number">5.</span> <span class="nav-text">使用Gallery和ImageSwitcher制作图片浏览器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用SeekBar制作可拖动的进度条"><span class="nav-number">6.</span> <span class="nav-text">使用SeekBar制作可拖动的进度条</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义SeekBar进度条样式————与ProgressBar类似"><span class="nav-number">6.1.</span> <span class="nav-text">自定义SeekBar进度条样式————与ProgressBar类似</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用SeekBar制作可拖动的进度条的步骤"><span class="nav-number">6.2.</span> <span class="nav-text">使用SeekBar制作可拖动的进度条的步骤</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android布局优化"><span class="nav-number">7.</span> <span class="nav-text">Android布局优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#推荐使用布局"><span class="nav-number">7.1.</span> <span class="nav-text">推荐使用布局</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#布局优化之include"><span class="nav-number">7.2.</span> <span class="nav-text">布局优化之include</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#布局优化之merge"><span class="nav-number">7.3.</span> <span class="nav-text">布局优化之merge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#布局优化之viewStub惰性加载"><span class="nav-number">7.4.</span> <span class="nav-text">布局优化之viewStub惰性加载</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注意事项"><span class="nav-number">8.</span> <span class="nav-text">注意事项</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">aiolos</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"aiolos123"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("5QTIOWC4jLjGHKUXBCRidUXY-gzGzoHsz", "LnJSjRjTBkyB7VThVKxbqlTk");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
